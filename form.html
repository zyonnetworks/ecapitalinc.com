<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bank</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="skins/minimal/minimal.css" rel="stylesheet">
    <link rel="stylesheet" href="css/nice-select.css">

    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="top">
      <div class="container">
        <div class="menu-bar pull-left">
          <a href="index.html" class="logo">Bank</a>
          <ul class="menu">
            <li><a href="about.html">ABOUT US</a></li>
            <li><a href="how-it-works.html">HOW IT WORKS?</a></li>
            <li><a href="faq.html">FAQ</a></li>
            <li><a href="form.html">CONTACT US</a></li>
          </ul>
        </div>
        <div class="social-icons pull-right">
          <ul class="social-icons">
            <li><a href="#" class="facebook-top">Facebook</a></li>
            <li><a href="#" class="twitter-top">Twitter</a></li>
            <li><a href="#" class="linkedin-top">Linkedin</a></li>
            <li><a href="#" class="blogger-top">Blogger</a></li>
          </ul>
          <a href="#" class="font-change increase-size">+</a>
          <a href="#" class="font-change decrease-size">-</a>
        </div>
      </div>
    </div>
    <div class="top-bg-v2">
      <div class="container">
        <div class="row">
          <div class="col-md-2 col-md-offset-2">
              <h2>CONTACT</h2>
              <p><strong>eCapital Inc.</strong> <br /><br />
              861 6th Ave <br />
              Ste 612 <br />
              San Diego, CA 92101 <br /><br />

              <a href="mailto:contact@ecapital.com">contact@ecapitalinc.com</a><br />
              <a href="#">858-34LOANS <br />(858-345-6267)</a></p>
          </div>
          <div class="col-md-8">
            <h2>PRE-QUALIFICATION LOAN APPLICATION</h2>
            <form id="formLead">
              <div class="form">
                <span class="circle-header">1</span>
                <h3>Loan Info</h3>
                <div class="form-box">
                  <div class="select-label">
                    <label><input type="radio" name="trust-deed" id="trust-deed" value="1st" checked>First trust deed</label>
                    <label><input type="radio" name="trust-deed" id="trust-deed" value="2nd">Second trust deed</label>
                  </div>
                  <label>
                    Amount requested
                    <input type="text" name="requestedLoanAmount" id="requestedLoanAmount"/>
                  </label>
                  <div class="select-label">
                    What is this loan for?
                    <select name="whatIsThisLoanFor">
                      <option value="Acquisition">Acquisition</option>
                      <option value="Refinance">Refinance</option>
                      <option value="Bridge loan">Bridge loan</option>
                      <option value="Fix & flip">Fix & Flip</option>
                    </select>
                  </div>
                  <div class="select-label">
                    Property Type
                    <select name="propertyType">
                      <option value="Single Family Residence">Single Family Residence</option>
                      <option value="Multifamily">Multifamily</option>
                      <option value="Retail">Retail</option>
                      <option value="Industrial">Industrial</option>
                      <option value="Office">Office</option>
                      <option value="Land">Land</option>
                      <option value="Other">Other</option>
                    </select>
                  </div>

                  <label>
                    Estimated Current Debt Balance (1st)
                    <input type="text" name="estimatedCurrentDebtBalance1st" id="estimatedCurrentDebtBalance1st"/>
                  </label>

                  <label id="estimatedCurrentDebtBalance2ndContainer">
                    Estimated Current Debt Balance (2nd)
                    <input type="text" name="estimatedCurrentDebtBalance2nd" id="estimatedCurrentDebtBalance2nd"/>
                  </label>

                  <label>
                    Property Address
                    <input type="text" name"propertyAddress" id="propertyAddress" />
                  </label>
                  <label>
                    City
                    <input type="text" name="propertyCity" id="propertyCity" />
                  </label>
                  <label>
                    Zip
                    <input type="text" name="propertyZip" id="propertyZip" />
                  </label>
                  <span class="small-text">Please note that we currently lend only in California.</span>
                </div>
                <span class="circle-header">2</span>
                <h3>Applicant Information</h3>
                <div class="form-box">
                  <label>
                    First Name
                    <input type="text" name="firstName" id="firstName" />
                  </label>
                  <label>
                    Last Name
                    <input type="text" name"lastName" id="lastName" />
                  </label>
                  <div class="select-label">
                    <span>Owner Occupied?</span>
                    <label><input type="radio" name="ownerOccupied" id="ownerOccupied" value=true>Yes</label>
                    <label><input type="radio" name="ownerOccupied" id="ownerOccupied" value=false checked>No</label>
                  </div>
                  <div class="owner-occupied-message">
                    <p>We're not lending money on owner occupied estates.</p>
                  </div>
                  <label>
                    Email
                    <input type="text" name="email" id="email"/>
                  </label>
                  <label>
                    Phone
                    <input type="text" name="phone" id="phone"/>
                  </label>
                  <div class="select-label">
                    <span>Are you a Broker or Borrower?</span>
                    <label><input type="radio" name="brokerOrBorrower" value"Broker">Broker</label>
                    <label><input type="radio" name="brokerOrBorrower" value="Borrower" checked>Borrower</label>
                  </div>
                  <div class="select-label">
                    <span>Do You Own More Than One Investment Property?</span>
                    <label><input type="radio" name="ownMoreThanOneInvestmentProperty" value=true>Yes</label>
                    <label><input type="radio" name="ownMoreThanOneInvestmentProperty" value=false checked>No</label>
                  </div>
                  <div>
                    <label>Comments
                      <input type="text" name="comments" />
                    </label>
                  </div>

                </div>
                <button type="submit">SUBMIT</button>
              </div>
          </form>
          </div>
        </div>
      </div>
    </div>
    <div class="contact-bar">
      <div class="container">
        <div class="row">
          <div class="col-sm-6">
            <p>861 6th Ave <br />
            Ste 612 <br />
            San Diego, CA 92101</p>
          </div>
          <!--<div class="col-sm-3">
            <h4>Postal Address</h3>
            <p>PO Box 16122 Collins Street <br />
            Victoria 8007 Australia</p>
          </div>-->
          <div class="col-sm-6 text-right">
            <h4>Contact Our Agent Now!</h4>
            <span class="big-text">858-34LOANS <span>(858-345-6267)</span></span>
          </div>
        </div>
      </div>
    </div>
    <div class="footer-links">
      <div class="container">
        <div class="row">
          <div class="col-sm-4">
            <a href="#" class="footer-logo">Bank</a>
            <p>eLending.  Real estate loans for investors. Hard Money Loans, Loans with no credit checks. Loans with no tax returns, Loans without income verification. <br /> We also lend against luxury assets, click <a href="#">here to learn more</a></p>
          </div>
          <div class="col-sm-4 helpful-links">
            <h4>HELPFUL LINKS</h4>
            <ul>
              <li><a href="#">Apply Now</a></li>
              <li><a href="#">About</a></li>
              <li><a href="#">Services</a></li>
              <li><a href="#">Company news</a></li>
            </ul>
          </div>
          <div class="col-sm-4">
            <h4>SOCIAL</h4>
            <ul>
              <li><a href="#">Yelp</a></li>
              <li><a href="#">Twitter</a></li>
              <li><a href="#">LinkedIn</a></li>
              <li><a href="#">Facebook</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <footer>
      <div class="container">
        <p>ELENDING 2016 Â© / ALL RIGHTS RESERVED</p>
        <ul class="social-links-bottom pull-right">
          <li><a href="#" class="linkedin-bottom">Linkedin</a></li>
          <li><a href="#" class="facebook-bottom">Facebook</a></li>
          <li><a href="#" class="google-bottom">Google+</a></li>
          <li><a href="#" class="twitter-bottom">Twitter</a></li>
          <li><a href="#" class="youtube-bottom">Youtube</a></li>
        </ul>
      </div>
    </footer>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/jquery.nice-select.js"></script>
    <script src="js/icheck.min.js"></script>
    <script src="js/jquery.mask.js"></script>
     <script src="js/bootstrap.min.js"></script>
     <script type="text/javascript">
    function getFormData($form){
      var unindexed_array = $form.serializeArray();
      var indexed_array = {};

      $.map(unindexed_array, function(n, i){
          if(n['value'] == "true") n['value'] = true;
          if(n['value'] == "false") n['value'] = false;
          indexed_array[n['name']] = n['value'];
      });
      return indexed_array;
    }

    $(document).ready(function() {
      $('select').niceSelect();
      $(".form-message").hide();
      $(".form button").click(function(){
        $(".form-message").fadeIn(1000);
      });
      $(".owner-occupied-message").hide();
      $('input:radio[name="ownerOccupied"]').on('ifChanged', function(event){
        if ($(this).val() == 'true') {
          $('.owner-occupied-message').show();
          $('button[type="submit"]').attr('disabled','disabled');
        }
        else {
          $('.owner-occupied-message').hide();
          $('button[type="submit"]').removeAttr('disabled');
        }
      });
      $('input').iCheck({
        checkboxClass: 'icheckbox_minimal',
        radioClass: 'iradio_minimal',
        increaseArea: '20%' // optional
      });
      $(".decrease-size").hide();
      $(".increase-size").click(function(){
          $(this).hide();
          $(".decrease-size").show();
          $("body").addClass("big-font");
      });
      $(".decrease-size").click(function(){
        $(this).hide();
        $(".increase-size").show();
        $("body").removeClass("big-font");
      });

      $('#requestedLoanAmount').mask('000,000,000,000,000', {reverse: true});
      $('#estimatedCurrentDebtBalance1st').mask('000,000,000,000,000', {reverse: true});
      $('#estimatedCurrentDebtBalance2nd').mask('000,000,000,000,000', {reverse: true});

      $('#phone').mask('(000) 000-0000', {placeholder: "(___) ___-____"});
      $('#propertyZip').mask('00000');

      $('#estimatedCurrentDebtBalance2ndContainer').hide();

      $('input:radio[name="trust-deed"]').on('ifChanged', function(event){
        if ($(this).val() == '2nd') {
          $('#estimatedCurrentDebtBalance2ndContainer').show();
        }
        else {
          $('#estimatedCurrentDebtBalance2ndContainer').hide();
        }
      });

      $( "form").submit(function( event ) {
          event.preventDefault();

          var dataString = getFormData($("#formLead"));
          delete dataString["trust-deed"];
          dataString.leadDomain = "ecapitalinc.com";
          dataString.leadType = "Web";
          dataString.leadStatus = "Lead";
          // todo : serializeArray not returning all fields
          dataString.lastName = $('#lastName').val();
          dataString.propertyAddress = $('#propertyAddress').val();
          dataString.phone = dataString.phone.replace(/-/g, '').replace(/\(|\)/g, '').replace(/ /g, '');
          dataString.requestedLoanAmount = $('#requestedLoanAmount').cleanVal();
          dataString.estimatedCurrentDebtBalance1st = $('#estimatedCurrentDebtBalance1st').cleanVal();
          dataString.estimatedCurrentDebtBalance2nd = $('#estimatedCurrentDebtBalance2nd').cleanVal();

          console.log(dataString);

          if(dataString.firstName && dataString.lastName && dataString.phone && dataString.email) {
              console.log('all set');
          } else {
              alert('Please fill in all required fields.');
              return false;
          }

          var postUrl = "http://crm-staging.elendinginc.com/methods/createLead";
          //var postUrl = "http://localhost:3000/methods/createLead";

          $.ajax({
            method: "post",
            url: postUrl,
            data: JSON.stringify(dataString),
            contentType: "application/json",
            success: function (data) {
              console.log(data); // 6
              alert('Your information has been forwarded to our agent. Someone will be in contact with you as soon as possible.');
            }
          });
      });
     });
 </script>

  </body>
</html>
